{"ast":null,"code":"import _objectSpread from \"/Users/xuanmingcui/Documents/projects/ailab-webapp-frontend/analytics-webapp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"/Users/xuanmingcui/Documents/projects/ailab-webapp-frontend/analytics-webapp/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/xuanmingcui/Documents/projects/ailab-webapp-frontend/analytics-webapp/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"/Users/xuanmingcui/Documents/projects/ailab-webapp-frontend/analytics-webapp/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/Users/xuanmingcui/Documents/projects/ailab-webapp-frontend/analytics-webapp/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/xuanmingcui/Documents/projects/ailab-webapp-frontend/analytics-webapp/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nvar _jsxFileName = \"/Users/xuanmingcui/Documents/projects/ailab-webapp-frontend/analytics-webapp/src/components/Charts/StockChart.js\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { format } from \"d3-format\";\nimport { timeFormat } from \"d3-time-format\";\nimport { ChartCanvas, Chart } from \"react-stockcharts\";\nimport { BarSeries, AreaSeries, CandlestickSeries, LineSeries, MACDSeries } from \"react-stockcharts/lib/series\";\nimport { XAxis, YAxis } from \"react-stockcharts/lib/axes\";\nimport { CrossHairCursor, EdgeIndicator, CurrentCoordinate, MouseCoordinateX, MouseCoordinateY } from \"react-stockcharts/lib/coordinates\";\nimport { discontinuousTimeScaleProvider } from \"react-stockcharts/lib/scale\";\nimport { OHLCTooltip, MovingAverageTooltip, MACDTooltip } from \"react-stockcharts/lib/tooltip\";\nimport { ema, macd, sma } from \"react-stockcharts/lib/indicator\";\nimport { FibonacciRetracement, DrawingObjectSelector } from \"react-stockcharts/lib/interactive\";\nimport { fitWidth } from \"react-stockcharts/lib/helper\";\nimport { last, toObject } from \"react-stockcharts/lib/utils\";\nimport { saveInteractiveNodes, getInteractiveNodes } from \"./interactiveutils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar macdAppearance = {\n  stroke: {\n    macd: \"#FF0000\",\n    signal: \"#00F300\"\n  },\n  fill: {\n    divergence: \"#4682B4\"\n  }\n};\n\nvar CandleStickChartWithFibonacciInteractiveIndicator = /*#__PURE__*/function (_React$Component) {\n  _inherits(CandleStickChartWithFibonacciInteractiveIndicator, _React$Component);\n\n  var _super = _createSuper(CandleStickChartWithFibonacciInteractiveIndicator);\n\n  function CandleStickChartWithFibonacciInteractiveIndicator(props) {\n    var _this;\n\n    _classCallCheck(this, CandleStickChartWithFibonacciInteractiveIndicator);\n\n    _this = _super.call(this, props);\n    _this.onKeyPress = _this.onKeyPress.bind(_assertThisInitialized(_this));\n    _this.onFibComplete1 = _this.onFibComplete1.bind(_assertThisInitialized(_this));\n    _this.onFibComplete3 = _this.onFibComplete3.bind(_assertThisInitialized(_this));\n    _this.handleSelection = _this.handleSelection.bind(_assertThisInitialized(_this));\n    _this.saveInteractiveNodes = saveInteractiveNodes.bind(_assertThisInitialized(_this));\n    _this.getInteractiveNodes = getInteractiveNodes.bind(_assertThisInitialized(_this));\n    _this.saveCanvasNode = _this.saveCanvasNode.bind(_assertThisInitialized(_this));\n    _this.state = {\n      enableFib: true,\n      retracements_1: [],\n      retracements_3: []\n    };\n    return _this;\n  }\n\n  _createClass(CandleStickChartWithFibonacciInteractiveIndicator, [{\n    key: \"saveCanvasNode\",\n    value: function saveCanvasNode(node) {\n      this.canvasNode = node;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener(\"keyup\", this.onKeyPress);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"keyup\", this.onKeyPress);\n    }\n  }, {\n    key: \"handleSelection\",\n    value: function handleSelection(interactives) {\n      var state = toObject(interactives, function (each) {\n        return [\"retracements_\".concat(each.chartId), each.objects];\n      });\n      this.setState(state);\n    }\n  }, {\n    key: \"onFibComplete1\",\n    value: function onFibComplete1(retracements_1) {\n      this.setState({\n        retracements_1: retracements_1,\n        enableFib: false\n      });\n    }\n  }, {\n    key: \"onFibComplete3\",\n    value: function onFibComplete3(retracements_3) {\n      this.setState({\n        retracements_3: retracements_3,\n        enableFib: false\n      });\n    }\n  }, {\n    key: \"onKeyPress\",\n    value: function onKeyPress(e) {\n      var keyCode = e.which;\n\n      switch (keyCode) {\n        case 46:\n          {\n            // DEL\n            var retracements_1 = this.state.retracements_1.filter(function (each) {\n              return !each.selected;\n            });\n            var retracements_3 = this.state.retracements_3.filter(function (each) {\n              return !each.selected;\n            });\n            this.canvasNode.cancelDrag();\n            this.setState({\n              retracements_1: retracements_1,\n              retracements_3: retracements_3\n            });\n            break;\n          }\n\n        case 27:\n          {\n            // ESC\n            this.canvasNode.cancelDrag();\n            this.node_1.terminate();\n            this.node_3.terminate();\n            this.setState({\n              enableFib: false\n            });\n            break;\n          }\n\n        case 68: // D - Draw Fib\n\n        case 69:\n          {\n            // E - Enable Fib\n            this.setState({\n              enableFib: true\n            });\n            break;\n          }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          type = _this$props.type,\n          initialData = _this$props.data,\n          width = _this$props.width,\n          ratio = _this$props.ratio;\n      var ema26 = ema().id(0).options({\n        windowSize: 26\n      }).merge(function (d, c) {\n        d.ema26 = c;\n      }).accessor(function (d) {\n        return d.ema26;\n      });\n      var ema12 = ema().id(1).options({\n        windowSize: 12\n      }).merge(function (d, c) {\n        d.ema12 = c;\n      }).accessor(function (d) {\n        return d.ema12;\n      });\n      var macdCalculator = macd().options({\n        fast: 12,\n        slow: 26,\n        signal: 9\n      }).merge(function (d, c) {\n        d.macd = c;\n      }).accessor(function (d) {\n        return d.macd;\n      });\n      var smaVolume50 = sma().id(3).options({\n        windowSize: 50,\n        sourcePath: \"volume\"\n      }).merge(function (d, c) {\n        d.smaVolume50 = c;\n      }).accessor(function (d) {\n        return d.smaVolume50;\n      });\n      var calculatedData = macdCalculator(smaVolume50(ema12(ema26(initialData))));\n      var xScaleProvider = discontinuousTimeScaleProvider.inputDateAccessor(function (d) {\n        return d.date;\n      });\n\n      var _xScaleProvider = xScaleProvider(calculatedData),\n          data = _xScaleProvider.data,\n          xScale = _xScaleProvider.xScale,\n          xAccessor = _xScaleProvider.xAccessor,\n          displayXAccessor = _xScaleProvider.displayXAccessor;\n\n      var start = xAccessor(last(data));\n      var end = xAccessor(data[Math.max(0, data.length - 150)]);\n      var xExtents = [start, end];\n      return /*#__PURE__*/_jsxDEV(ChartCanvas, {\n        ref: this.saveCanvasNode,\n        height: 600,\n        width: width,\n        ratio: ratio,\n        margin: {\n          left: 70,\n          right: 70,\n          top: 20,\n          bottom: 30\n        },\n        type: type,\n        seriesName: \"MSFT\",\n        data: data,\n        xScale: xScale,\n        xAccessor: xAccessor,\n        displayXAccessor: displayXAccessor,\n        xExtents: xExtents,\n        children: [/*#__PURE__*/_jsxDEV(Chart, {\n          id: 1,\n          height: 400,\n          yExtents: [function (d) {\n            return [d.high, d.low];\n          }, ema26.accessor(), ema12.accessor()],\n          padding: {\n            top: 10,\n            bottom: 20\n          },\n          children: [/*#__PURE__*/_jsxDEV(XAxis, {\n            axisAt: \"bottom\",\n            orient: \"bottom\",\n            showTicks: false,\n            outerTickSize: 0\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n            axisAt: \"right\",\n            orient: \"right\",\n            ticks: 5\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(MouseCoordinateY, {\n            at: \"right\",\n            orient: \"right\",\n            displayFormat: format(\".2f\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(CandlestickSeries, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(LineSeries, {\n            yAccessor: ema26.accessor(),\n            stroke: ema26.stroke()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(LineSeries, {\n            yAccessor: ema12.accessor(),\n            stroke: ema12.stroke()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(CurrentCoordinate, {\n            yAccessor: ema26.accessor(),\n            fill: ema26.stroke()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(CurrentCoordinate, {\n            yAccessor: ema12.accessor(),\n            fill: ema12.stroke()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(EdgeIndicator, {\n            itemType: \"last\",\n            orient: \"right\",\n            edgeAt: \"right\",\n            yAccessor: function yAccessor(d) {\n              return d.close;\n            },\n            fill: function fill(d) {\n              return d.close > d.open ? \"#6BA583\" : \"#FF0000\";\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(OHLCTooltip, {\n            origin: [-40, 0]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(MovingAverageTooltip, {\n            onClick: function onClick(e) {\n              return console.log(e);\n            },\n            origin: [-38, 15],\n            options: [{\n              yAccessor: ema26.accessor(),\n              type: ema26.type(),\n              stroke: ema26.stroke(),\n              windowSize: ema26.options().windowSize\n            }, {\n              yAccessor: ema12.accessor(),\n              type: ema12.type(),\n              stroke: ema12.stroke(),\n              windowSize: ema12.options().windowSize\n            }]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(FibonacciRetracement, {\n            ref: this.saveInteractiveNodes(\"FibonacciRetracement\", 1),\n            enabled: this.state.enableFib,\n            retracements: this.state.retracements_1,\n            onComplete: this.onFibComplete1\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 6\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(Chart, {\n          id: 2,\n          height: 150,\n          yExtents: [function (d) {\n            return d.volume;\n          }, smaVolume50.accessor()],\n          origin: function origin(w, h) {\n            return [0, h - 300];\n          },\n          children: [/*#__PURE__*/_jsxDEV(YAxis, {\n            axisAt: \"left\",\n            orient: \"left\",\n            ticks: 5,\n            tickFormat: format(\".2s\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(MouseCoordinateY, {\n            at: \"left\",\n            orient: \"left\",\n            displayFormat: format(\".4s\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(BarSeries, {\n            yAccessor: function yAccessor(d) {\n              return d.volume;\n            },\n            fill: function fill(d) {\n              return d.close > d.open ? \"#6BA583\" : \"#FF0000\";\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(AreaSeries, {\n            yAccessor: smaVolume50.accessor(),\n            stroke: smaVolume50.stroke(),\n            fill: smaVolume50.fill()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 6\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(Chart, {\n          id: 3,\n          height: 150,\n          yExtents: macdCalculator.accessor(),\n          origin: function origin(w, h) {\n            return [0, h - 150];\n          },\n          padding: {\n            top: 10,\n            bottom: 10\n          },\n          children: [/*#__PURE__*/_jsxDEV(XAxis, {\n            axisAt: \"bottom\",\n            orient: \"bottom\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n            axisAt: \"right\",\n            orient: \"right\",\n            ticks: 2\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(MouseCoordinateX, {\n            at: \"bottom\",\n            orient: \"bottom\",\n            displayFormat: timeFormat(\"%Y-%m-%d\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(MouseCoordinateY, {\n            at: \"right\",\n            orient: \"right\",\n            displayFormat: format(\".2f\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(MACDSeries, _objectSpread({\n            yAccessor: function yAccessor(d) {\n              return d.macd;\n            }\n          }, macdAppearance), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(FibonacciRetracement, {\n            ref: this.saveInteractiveNodes(\"FibonacciRetracement\", 3),\n            enabled: this.state.enableFib,\n            type: \"BOUND\",\n            retracements: this.state.retracements_3,\n            onComplete: this.onFibComplete3\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(MACDTooltip, {\n            origin: [-38, 15],\n            yAccessor: function yAccessor(d) {\n              return d.macd;\n            },\n            options: macdCalculator.options(),\n            appearance: macdAppearance\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 6\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(CrossHairCursor, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(DrawingObjectSelector, {\n          enabled: !this.state.enableFib,\n          getInteractiveNodes: this.getInteractiveNodes,\n          drawingObjectMap: {\n            FibonacciRetracement: \"retracements\"\n          },\n          onSelect: this.handleSelection\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 5\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 4\n      }, this);\n    }\n  }]);\n\n  return CandleStickChartWithFibonacciInteractiveIndicator;\n}(React.Component);\n\nCandleStickChartWithFibonacciInteractiveIndicator.propTypes = {\n  data: PropTypes.array.isRequired,\n  width: PropTypes.number.isRequired,\n  ratio: PropTypes.number.isRequired,\n  type: PropTypes.oneOf([\"svg\", \"hybrid\"]).isRequired\n};\nCandleStickChartWithFibonacciInteractiveIndicator.defaultProps = {\n  type: \"svg\"\n};\nCandleStickChartWithFibonacciInteractiveIndicator = fitWidth(CandleStickChartWithFibonacciInteractiveIndicator);\nexport default CandleStickChartWithFibonacciInteractiveIndicator;","map":{"version":3,"sources":["/Users/xuanmingcui/Documents/projects/ailab-webapp-frontend/analytics-webapp/src/components/Charts/StockChart.js"],"names":["React","PropTypes","format","timeFormat","ChartCanvas","Chart","BarSeries","AreaSeries","CandlestickSeries","LineSeries","MACDSeries","XAxis","YAxis","CrossHairCursor","EdgeIndicator","CurrentCoordinate","MouseCoordinateX","MouseCoordinateY","discontinuousTimeScaleProvider","OHLCTooltip","MovingAverageTooltip","MACDTooltip","ema","macd","sma","FibonacciRetracement","DrawingObjectSelector","fitWidth","last","toObject","saveInteractiveNodes","getInteractiveNodes","macdAppearance","stroke","signal","fill","divergence","CandleStickChartWithFibonacciInteractiveIndicator","props","onKeyPress","bind","onFibComplete1","onFibComplete3","handleSelection","saveCanvasNode","state","enableFib","retracements_1","retracements_3","node","canvasNode","document","addEventListener","removeEventListener","interactives","each","chartId","objects","setState","e","keyCode","which","filter","selected","cancelDrag","node_1","terminate","node_3","type","initialData","data","width","ratio","ema26","id","options","windowSize","merge","d","c","accessor","ema12","macdCalculator","fast","slow","smaVolume50","sourcePath","calculatedData","xScaleProvider","inputDateAccessor","date","xScale","xAccessor","displayXAccessor","start","end","Math","max","length","xExtents","left","right","top","bottom","high","low","close","open","console","log","yAccessor","volume","w","h","Component","propTypes","array","isRequired","number","oneOf","defaultProps"],"mappings":"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","sourcesContent":["\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { format } from \"d3-format\";\nimport { timeFormat } from \"d3-time-format\";\n\nimport { ChartCanvas, Chart } from \"react-stockcharts\";\nimport {\n\tBarSeries,\n\tAreaSeries,\n\tCandlestickSeries,\n\tLineSeries,\n\tMACDSeries,\n} from \"react-stockcharts/lib/series\";\nimport { XAxis, YAxis } from \"react-stockcharts/lib/axes\";\nimport {\n\tCrossHairCursor,\n\tEdgeIndicator,\n\tCurrentCoordinate,\n\tMouseCoordinateX,\n\tMouseCoordinateY,\n} from \"react-stockcharts/lib/coordinates\";\n\nimport { discontinuousTimeScaleProvider } from \"react-stockcharts/lib/scale\";\nimport {\n\tOHLCTooltip,\n\tMovingAverageTooltip,\n\tMACDTooltip,\n} from \"react-stockcharts/lib/tooltip\";\nimport { ema, macd, sma } from \"react-stockcharts/lib/indicator\";\nimport { FibonacciRetracement, DrawingObjectSelector } from \"react-stockcharts/lib/interactive\";\nimport { fitWidth } from \"react-stockcharts/lib/helper\";\nimport { last, toObject } from \"react-stockcharts/lib/utils\";\nimport {\n\tsaveInteractiveNodes,\n\tgetInteractiveNodes,\n} from \"./interactiveutils\";\n\nconst macdAppearance = {\n\tstroke: {\n\t\tmacd: \"#FF0000\",\n\t\tsignal: \"#00F300\",\n\t},\n\tfill: {\n\t\tdivergence: \"#4682B4\"\n\t},\n};\n\nclass CandleStickChartWithFibonacciInteractiveIndicator extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.onKeyPress = this.onKeyPress.bind(this);\n\t\tthis.onFibComplete1 = this.onFibComplete1.bind(this);\n\t\tthis.onFibComplete3 = this.onFibComplete3.bind(this);\n\t\tthis.handleSelection = this.handleSelection.bind(this);\n\n\t\tthis.saveInteractiveNodes = saveInteractiveNodes.bind(this);\n\t\tthis.getInteractiveNodes = getInteractiveNodes.bind(this);\n\n\t\tthis.saveCanvasNode = this.saveCanvasNode.bind(this);\n\t\tthis.state = {\n\t\t\tenableFib: true,\n\t\t\tretracements_1: [],\n\t\t\tretracements_3: [],\n\t\t};\n\t}\n\tsaveCanvasNode(node) {\n\t\tthis.canvasNode = node;\n\t}\n\tcomponentDidMount() {\n\t\tdocument.addEventListener(\"keyup\", this.onKeyPress);\n\t}\n\tcomponentWillUnmount() {\n\t\tdocument.removeEventListener(\"keyup\", this.onKeyPress);\n\t}\n\thandleSelection(interactives) {\n\t\tconst state = toObject(interactives, each => {\n\t\t\treturn [\n\t\t\t\t`retracements_${each.chartId}`,\n\t\t\t\teach.objects,\n\t\t\t];\n\t\t});\n\t\tthis.setState(state);\n\t}\n\tonFibComplete1(retracements_1) {\n\t\tthis.setState({\n\t\t\tretracements_1,\n\t\t\tenableFib: false\n\t\t});\n\t}\n\tonFibComplete3(retracements_3) {\n\t\tthis.setState({\n\t\t\tretracements_3,\n\t\t\tenableFib: false\n\t\t});\n\t}\n\tonKeyPress(e) {\n\t\tconst keyCode = e.which;\n\t\tswitch (keyCode) {\n\t\tcase 46: { // DEL\n\t\t\tconst retracements_1 = this.state.retracements_1\n\t\t\t\t.filter(each => !each.selected);\n\t\t\tconst retracements_3 = this.state.retracements_3\n\t\t\t\t.filter(each => !each.selected);\n\n\t\t\tthis.canvasNode.cancelDrag();\n\t\t\tthis.setState({\n\t\t\t\tretracements_1,\n\t\t\t\tretracements_3,\n\t\t\t});\n\t\t\tbreak;\n\t\t}\n\t\tcase 27: { // ESC\n\t\t\tthis.canvasNode.cancelDrag();\n\t\t\tthis.node_1.terminate();\n\t\t\tthis.node_3.terminate();\n\t\t\tthis.setState({\n\t\t\t\tenableFib: false\n\t\t\t});\n\t\t\tbreak;\n\t\t}\n\t\tcase 68:   // D - Draw Fib\n\t\tcase 69: { // E - Enable Fib\n\t\t\tthis.setState({\n\t\t\t\tenableFib: true\n\t\t\t});\n\t\t\tbreak;\n\t\t}\n\t\t}\n\t}\n\trender() {\n\t\tconst { type, data: initialData, width, ratio } = this.props;\n\t\tconst ema26 = ema()\n\t\t\t.id(0)\n\t\t\t.options({ windowSize: 26 })\n\t\t\t.merge((d, c) => { d.ema26 = c; })\n\t\t\t.accessor(d => d.ema26);\n\n\t\tconst ema12 = ema()\n\t\t\t.id(1)\n\t\t\t.options({ windowSize: 12 })\n\t\t\t.merge((d, c) => {d.ema12 = c;})\n\t\t\t.accessor(d => d.ema12);\n\n\t\tconst macdCalculator = macd()\n\t\t\t.options({\n\t\t\t\tfast: 12,\n\t\t\t\tslow: 26,\n\t\t\t\tsignal: 9,\n\t\t\t})\n\t\t\t.merge((d, c) => {d.macd = c;})\n\t\t\t.accessor(d => d.macd);\n\n\t\tconst smaVolume50 = sma()\n\t\t\t.id(3)\n\t\t\t.options({\n\t\t\t\twindowSize: 50,\n\t\t\t\tsourcePath: \"volume\",\n\t\t\t})\n\t\t\t.merge((d, c) => {d.smaVolume50 = c;})\n\t\t\t.accessor(d => d.smaVolume50);\n\n\n\t\tconst calculatedData = macdCalculator(smaVolume50(ema12(ema26(initialData))));\n\t\tconst xScaleProvider = discontinuousTimeScaleProvider\n\t\t\t.inputDateAccessor(d => d.date);\n\t\tconst {\n\t\t\tdata,\n\t\t\txScale,\n\t\t\txAccessor,\n\t\t\tdisplayXAccessor,\n\t\t} = xScaleProvider(calculatedData);\n\n\t\tconst start = xAccessor(last(data));\n\t\tconst end = xAccessor(data[Math.max(0, data.length - 150)]);\n\t\tconst xExtents = [start, end];\n\n\t\treturn (\n\t\t\t<ChartCanvas ref={this.saveCanvasNode}\n\t\t\t\theight={600}\n\t\t\t\twidth={width}\n\t\t\t\tratio={ratio}\n\t\t\t\tmargin={{ left: 70, right: 70, top: 20, bottom: 30 }}\n\t\t\t\ttype={type}\n\t\t\t\tseriesName=\"MSFT\"\n\t\t\t\tdata={data}\n\t\t\t\txScale={xScale}\n\t\t\t\txAccessor={xAccessor}\n\t\t\t\tdisplayXAccessor={displayXAccessor}\n\t\t\t\txExtents={xExtents}\n\t\t\t>\n\n\t\t\t\t<Chart id={1} height={400}\n\t\t\t\t\tyExtents={[d => [d.high, d.low], ema26.accessor(), ema12.accessor()]}\n\t\t\t\t\tpadding={{ top: 10, bottom: 20 }}\n\t\t\t\t>\n\t\t\t\t\t<XAxis axisAt=\"bottom\" orient=\"bottom\" showTicks={false} outerTickSize={0} />\n\t\t\t\t\t<YAxis axisAt=\"right\" orient=\"right\" ticks={5} />\n\t\t\t\t\t<MouseCoordinateY\n\t\t\t\t\t\tat=\"right\"\n\t\t\t\t\t\torient=\"right\"\n\t\t\t\t\t\tdisplayFormat={format(\".2f\")} />\n\n\t\t\t\t\t<CandlestickSeries />\n\t\t\t\t\t<LineSeries yAccessor={ema26.accessor()} stroke={ema26.stroke()}/>\n\t\t\t\t\t<LineSeries yAccessor={ema12.accessor()} stroke={ema12.stroke()}/>\n\n\t\t\t\t\t<CurrentCoordinate yAccessor={ema26.accessor()} fill={ema26.stroke()} />\n\t\t\t\t\t<CurrentCoordinate yAccessor={ema12.accessor()} fill={ema12.stroke()} />\n\n\t\t\t\t\t<EdgeIndicator itemType=\"last\" orient=\"right\" edgeAt=\"right\"\n\t\t\t\t\t\tyAccessor={d => d.close}\n\t\t\t\t\t\tfill={d => d.close > d.open ? \"#6BA583\" : \"#FF0000\"}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<OHLCTooltip origin={[-40, 0]}/>\n\t\t\t\t\t<MovingAverageTooltip\n\t\t\t\t\t\tonClick={e => console.log(e)}\n\t\t\t\t\t\torigin={[-38, 15]}\n\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tyAccessor: ema26.accessor(),\n\t\t\t\t\t\t\t\ttype: ema26.type(),\n\t\t\t\t\t\t\t\tstroke: ema26.stroke(),\n\t\t\t\t\t\t\t\twindowSize: ema26.options().windowSize,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tyAccessor: ema12.accessor(),\n\t\t\t\t\t\t\t\ttype: ema12.type(),\n\t\t\t\t\t\t\t\tstroke: ema12.stroke(),\n\t\t\t\t\t\t\t\twindowSize: ema12.options().windowSize,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<FibonacciRetracement\n\t\t\t\t\t\tref={this.saveInteractiveNodes(\"FibonacciRetracement\", 1)}\n\t\t\t\t\t\tenabled={this.state.enableFib}\n\t\t\t\t\t\tretracements={this.state.retracements_1}\n\t\t\t\t\t\tonComplete={this.onFibComplete1}\n\t\t\t\t\t/>\n\t\t\t\t</Chart>\n\t\t\t\t<Chart id={2} height={150}\n\t\t\t\t\tyExtents={[d => d.volume, smaVolume50.accessor()]}\n\t\t\t\t\torigin={(w, h) => [0, h - 300]}\n\t\t\t\t>\n\t\t\t\t\t<YAxis axisAt=\"left\" orient=\"left\" ticks={5} tickFormat={format(\".2s\")}/>\n\n\t\t\t\t\t<MouseCoordinateY\n\t\t\t\t\t\tat=\"left\"\n\t\t\t\t\t\torient=\"left\"\n\t\t\t\t\t\tdisplayFormat={format(\".4s\")} />\n\n\t\t\t\t\t<BarSeries yAccessor={d => d.volume} fill={d => d.close > d.open ? \"#6BA583\" : \"#FF0000\"} />\n\t\t\t\t\t<AreaSeries yAccessor={smaVolume50.accessor()} stroke={smaVolume50.stroke()} fill={smaVolume50.fill()}/>\n\t\t\t\t</Chart>\n\t\t\t\t<Chart id={3} height={150}\n\t\t\t\t\tyExtents={macdCalculator.accessor()}\n\t\t\t\t\torigin={(w, h) => [0, h - 150]} padding={{ top: 10, bottom: 10 }}\n\t\t\t\t>\n\t\t\t\t\t<XAxis axisAt=\"bottom\" orient=\"bottom\"/>\n\t\t\t\t\t<YAxis axisAt=\"right\" orient=\"right\" ticks={2} />\n\t\t\t\t\t<MouseCoordinateX\n\t\t\t\t\t\tat=\"bottom\"\n\t\t\t\t\t\torient=\"bottom\"\n\t\t\t\t\t\tdisplayFormat={timeFormat(\"%Y-%m-%d\")} />\n\t\t\t\t\t<MouseCoordinateY\n\t\t\t\t\t\tat=\"right\"\n\t\t\t\t\t\torient=\"right\"\n\t\t\t\t\t\tdisplayFormat={format(\".2f\")} />\n\n\t\t\t\t\t<MACDSeries yAccessor={d => d.macd}\n\t\t\t\t\t\t{...macdAppearance} />\n\n\t\t\t\t\t<FibonacciRetracement\n\t\t\t\t\t\tref={this.saveInteractiveNodes(\"FibonacciRetracement\", 3)}\n\t\t\t\t\t\tenabled={this.state.enableFib}\n\t\t\t\t\t\ttype=\"BOUND\"\n\t\t\t\t\t\tretracements={this.state.retracements_3}\n\t\t\t\t\t\tonComplete={this.onFibComplete3}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<MACDTooltip\n\t\t\t\t\t\torigin={[-38, 15]}\n\t\t\t\t\t\tyAccessor={d => d.macd}\n\t\t\t\t\t\toptions={macdCalculator.options()}\n\t\t\t\t\t\tappearance={macdAppearance}\n\t\t\t\t\t/>\n\t\t\t\t</Chart>\n\t\t\t\t<CrossHairCursor />\n\t\t\t\t<DrawingObjectSelector\n\t\t\t\t\tenabled={!this.state.enableFib}\n\t\t\t\t\tgetInteractiveNodes={this.getInteractiveNodes}\n\t\t\t\t\tdrawingObjectMap={{\n\t\t\t\t\t\tFibonacciRetracement: \"retracements\"\n\t\t\t\t\t}}\n\t\t\t\t\tonSelect={this.handleSelection}\n\t\t\t\t/>\n\t\t\t</ChartCanvas>\n\t\t);\n\t}\n}\nCandleStickChartWithFibonacciInteractiveIndicator.propTypes = {\n\tdata: PropTypes.array.isRequired,\n\twidth: PropTypes.number.isRequired,\n\tratio: PropTypes.number.isRequired,\n\ttype: PropTypes.oneOf([\"svg\", \"hybrid\"]).isRequired,\n};\n\nCandleStickChartWithFibonacciInteractiveIndicator.defaultProps = {\n\ttype: \"svg\",\n};\n\nCandleStickChartWithFibonacciInteractiveIndicator = fitWidth(CandleStickChartWithFibonacciInteractiveIndicator);\n\nexport default CandleStickChartWithFibonacciInteractiveIndicator;\n"]},"metadata":{},"sourceType":"module"}